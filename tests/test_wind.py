from tawhiri.wind import Dataset

class TestDataset(object):
    def setUp(self):
        self.d = Dataset("/home/adam/Projects/tawhiri/datasets", 2014, 2, 3, 6)

    def test_reads_var(self):
        v = self.d._read_var(10, 10, 1, 100, 100)
        assert v == 1.26

    def test_pressure_heights(self):
        h = self.d.get_pressure_heights(10.0, 52.2, 0.2)
        assert h == (
            -141.79003125, 62.870984375, 271.89300048828125, 485.11,
            703.053, 926.2360625, 1154.9250625, 1389.190125, 1629.428,
            1876.452, 2130.66, 2392.17425, 2661.27625, 2938.66225, 3225.486,
            3522.111, 3829.35, 4148.212, 4479.7415, 4824.5025000000005,
            5182.79, 5555.08, 5942.16, 6345.93, 6768.409375, 7211.82,
            7679.110000000001, 8172.84, 8696.27, 9255.62, 9867.33, 10557.29,
            11336.880000000001, 12226.64, 13250.880000000001,
            14458.970000000001, 15939.45, 18301.76875, 20532.66,
            23950.947500000002, 26685.2375, 31436.33, 33957.9, 36399.55,
            40215.5, 43345.3775, 48793.92)

    def test_wind(self):
        h = self.d.get_wind(10.0, 12345.0, 52.2, 0.2)
        assert h == (23.95639001135134, 2.5721199676629682)
